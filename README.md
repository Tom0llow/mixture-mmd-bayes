# mmd-bayes

This repository runs Gaussian Mixture Model (GMM) estimation experiments with an
MMD-based variational method, plus a gamma-scale sweep utility.

## Requirements

- Python 3.10+
- `uv` (recommended runner/package tool)
- For `parallel` mode: at least 2 CUDA GPUs

## Setup

From the repository root:

```bash
uv sync
```

## Run Experiments

Default entrypoint:

```bash
uv run python gmm_estimation/src/main.py --mode experiment
```

`--mode experiment` loads:

- `gmm_estimation/configs/experiments.yaml`
- `gmm_estimation/configs/opt.yaml`
- `gmm_estimation/configs/runner.yaml`

Important:

- `runner.yaml` currently defaults to `mode: parallel`.
- Parallel execution requires at least 2 GPUs.
- If you want CPU/single-GPU execution, set `mode: sequential` in
  `gmm_estimation/configs/runner.yaml`.

## Run Gamma Sweep

```bash
uv run python gmm_estimation/src/main.py --mode gamma_sweep
```

This additionally uses:

- `gmm_estimation/configs/gamma_sweep.yaml`

`gamma_sweep.yaml` expects:

- A single scenario name that exists in `experiments.yaml`
- A non-empty `gamma_scales` list

## Results

Outputs are written under:

- `gmm_estimation/results/<timestamp>/...`

Typical artifacts include:

- `results.json`
- `meta.json`
- Plot images generated by the corresponding plotting scripts

For experiment mode, results are grouped by scenario under the same timestamp
folder. For gamma sweep mode, aggregated sweep results and a sweep plot are
saved in the timestamp folder.
